import{d as ye,j as xe,r as m,k as ke,a as w,o as n,b as l,M as h,h as e,w as B,v as R,A as M,f,m as c,n as q,l as x,N as ie,i as k,t as s,F as L,e as le,J as Ie,B as re,O as Ne,Q as we,R as Se}from"./index-fb5e0693.js";import{f as S}from"./formatters-7d8279ee.js";const qe={class:"flex flex-col gap-4"},Ce=e("div",{class:"text-3xl font-bold"},"Uniq Explorer",-1),De=e("div",null,"Start the search by entering the Uniq ID, or factory ID and serial number",-1),Oe={key:0,class:"flex flex-col gap-4"},$e=e("div",{class:"font-bold"},"Search by Uniq",-1),Ue={class:"flex flex-row gap-4"},Te={key:0},Pe={key:1,class:"flex flex-col gap-4"},Ee=e("div",{class:"font-bold"},"Search by Factory ID & Serial Number",-1),Fe={class:"flex flex-row gap-4 h-12"},Be={key:0},Re={key:3,class:"flex flex-col justify-center items-center gap-4"},Me=e("div",null,"Sorry, there seems to be no results for your search",-1),Le={key:4,class:"flex flex-col gap-4 mt-4"},Ve=e("div",{class:"text-2xl font-bold"},"On Chain",-1),Ke={class:"flex flex-col bg-neutral-800 pl-4 pr-4 pt-4 pb-4 rounded border border-neutral-700 text-neutral-300 [&>*]:border-b [&>*]:border-neutral-600 [&>*]:pb-3 [&>*]:pt-3"},Qe={class:"grid grid-cols-4 gap-4 items-center !pt-0"},Ae=e("div",{class:"col-span-1"},"Uniq ID",-1),ze={class:"col-span-3"},Je={class:"grid grid-cols-4 gap-4 items-center"},je=e("div",{class:"col-span-1"},"Created On",-1),Xe={class:"col-span-3"},Ye={class:"grid grid-cols-4 gap-4 items-center"},He=e("div",{class:"col-span-1"},"Serial Number",-1),Ge={class:"col-span-3"},We={class:"grid grid-cols-4 gap-4 items-center"},Ze=e("div",{class:"col-span-1"},"Owner",-1),et={class:"col-span-3"},tt=["href"],at={class:"grid grid-cols-4 gap-4 items-center"},st=e("div",{class:"col-span-1"},"Metadata URI",-1),ot={class:"col-span-3 truncate"},nt=["href"],it={class:"grid grid-cols-4 gap-4 items-center"},lt=e("div",{class:"col-span-1"},"Metadata Hash",-1),rt={class:"col-span-3 truncate"},ct={class:"grid grid-cols-4 gap-4 items-center"},dt=e("div",{class:"col-span-1"},"Factory ID",-1),ut={class:"col-span-3"},vt=["href"],_t={class:"grid grid-cols-4 gap-4 items-center !border-b-0 !pb-0"},pt=e("div",{class:"col-span-1"},"Explorer Link",-1),ht={class:"col-span-3"},ft=["href"],mt=e("div",{class:"text-2xl font-bold"},"Metadata",-1),bt={class:"flex flex-col bg-neutral-800 pl-4 pr-4 pt-4 pb-4 rounded border border-neutral-700 text-neutral-300 [&>*]:border-b [&>*]:border-neutral-600 [&>*]:pb-3 [&>*]:pt-3"},gt={class:"grid grid-cols-4 gap-4 items-center !pt-0"},yt=e("div",{class:"col-span-1"},"Type",-1),xt={class:"col-span-3"},kt={class:"grid grid-cols-4 gap-4 items-center"},It=e("div",{class:"col-span-1"},"Name",-1),Nt={class:"col-span-3"},wt={class:"grid grid-cols-4 gap-4 items-center"},St=e("div",{class:"col-span-1"},"Subname",-1),qt={class:"col-span-3"},Ct={class:"grid grid-cols-4 gap-4 items-center"},Dt=e("div",{class:"col-span-1"},"Description",-1),Ot={class:"col-span-3"},$t={class:"grid grid-cols-4 gap-4 items-center !pb-0 !border-b-0"},Ut=e("div",{class:"col-span-1"},"Attributes",-1),Tt={class:"col-span-3"},Pt={key:0,class:"flex flex-col gap-4 bg-neutral-700 p-4 rounded"},Et={class:"grid grid-cols-4 gap-4 items-center"},Ft={class:"col-span-1"},Bt={class:"col-span-3"},Rt=e("br",null,null,-1),Mt=e("div",{class:"text-2xl font-bold"},"Purchase Options / Listing",-1),Lt={class:"flex flex-col bg-neutral-800 pl-4 pr-4 pt-4 pb-4 rounded border border-neutral-700 text-neutral-300 [&>*]:border-b [&>*]:border-neutral-600 [&>*]:pb-3 [&>*]:pt-3"},Vt=e("div",{class:"grid grid-cols-4 gap-4 items-center"},[e("div",{class:"col-span-1"},"Second hand")],-1),Kt={class:"grid grid-cols-4 gap-4 items-center"},Qt=e("div",{class:"col-span-1"},"On Sale Date",-1),At={class:"col-span-3"},zt={class:"grid grid-cols-4 gap-4 items-center"},Jt=e("div",{class:"col-span-1"},"Price",-1),jt={class:"col-span-3"},Xt={key:0,class:"grid grid-cols-4 gap-4 items-center"},Yt=e("div",{class:"col-span-1"},"Promoter Share",-1),Ht={class:"col-span-3"},Gt={key:1,class:"grid grid-cols-4 gap-4 items-center !border-b-0"},Wt=e("div",{class:"col-span-1"},"Resale Shares",-1),Zt=[Wt],ea={class:"grid grid-cols-4 gap-4 items-center !pt-0 !border-b-0"},ta={class:"col-span-1"},aa=["href"],sa={class:"col-span-3"},oa=e("br",null,null,-1),na={class:"flex flex-col gap-4"},ia=e("div",{class:"text-2xl font-bold"},"Received Offers",-1),la={class:"bg-neutral-800 p-4 rounded border border-neutral-700"},ra=["href"],ca={key:1},da=["href"],ua={key:1},va=["href"],_a=e("p",null,"No Received Offers found",-1),pa={class:"flex flex-col gap-4"},ha=e("div",{class:"text-2xl font-bold"},"Media",-1),fa={class:"bg-neutral-800 p-4 rounded border border-neutral-700"},ma=e("h4",{class:"mt-2 mb-2"},"JSON Data",-1),ya=ye({__name:"index",props:{state:{},metadata:{}},emits:["transact","set-endpoint","set-page-state"],setup(ce,{emit:de}){const $=de,b=xe(),v=ce;let p=m(!1);const y=m(void 0),ue=m(1),I=m(void 0),ve=m(2),g=m(void 0),_e=m(3),C=m("waiting"),_=m(!1),a=m(null),d=m({pagination:{limit:25,skip:0},totalCount:0,data:[],dataTable:{headers:[{text:"Type",value:"type",sortable:!0},{text:"Offer Expiry",value:"expiryDate",sortable:!0},{text:"Bidder",value:"buyer"},{text:"Price",value:"price",sortable:!0},{text:"Status",value:"status"},{text:"Action",value:"cancelAction"}],rows:[]}});function U(r){y.value=r,ue.value++}function T(r,o){I.value=r,g.value=o,ve.value++,_e.value++}function V(){a.value=null,d.value={pagination:{limit:25,skip:0},totalCount:0,data:[],dataTable:{headers:d.value.dataTable.headers,rows:[]}}}function pe(){C.value="waiting",V(),U(void 0),T(void 0,void 0)}async function he(){Ie($,b),b.query.id&&(U(parseInt(b.query.id)),D()),b.query.factoryId&&b.query.serialNum&&(p.value=!0,T(parseInt(b.query.factoryId),parseInt(b.query.serialNum)),D())}async function D(){console.log({uid:y.value,fid:I.value,sno:g.value}),V(),_.value=!0;try{let r=null;if(y.value!=null&&(console.log("Search mode: uniqId",y.value),window.history.pushState("uniq","",`${b.path}?env=${re.environment}&id=${y.value}`),a.value=await Ne(y.value)),console.log(a.value),I.value!=null&&g.value!=null){console.log("Search mode: factoryId & serialNum",I.value,g.value),window.history.pushState("uniq","",`${b.path}?env=${re.environment}&factoryId=${I.value}&serialNum=${g.value}`);const o=await we(I.value,null,null,null,null,{min:g.value,max:g.value});o&&o.data[0]&&(a.value=o.data[0])}r=a.value.id,await K(r),C.value=a.value?"success":"failure"}catch(r){console.error(`findUniq error: ${r}`),C.value="error"}_.value=!1}async function K(r){_.value=!0;try{const o=await Se({owner:void 0,uniqId:r},d.value.pagination.limit,d.value.pagination.skip);d.value.data.push(...o.data),d.value.pagination.skip+=o.data.length,d.value.totalCount=o.totalCount,d.value.dataTable.rows=d.value.data.map(i=>{const u=new Date,O=new Date(i.expiryDate)<u?"EXPIRED":"ACTIVE";return{id:i.id,type:i.type,expiryDate:i.expiryDate,buyer:i.buyer,price:parseFloat(i.price.amount),priceUnit:i.price.currency.code,status:O,cancelAction:{type:i.type,uniqId:i.uniq.id,uniqFactoryId:i.uniqFactory.id,offerId:i.id,buyer:i.buyer,owner:i.uniq.owner,status:O}}})}catch(o){console.error("Error fetching received offers:",o)}finally{_.value=!1}}async function fe(r,o,i,u){let N=[{contract:"eosio.nft.ft",action:r=="UNIQ"?"acptnftofr.a":"acptfctofr.a",authorization:[{actor:v.state.accountName,permission:v.state.accountPerm?v.state.accountPerm:"active"}],data:{owner:o,nft_id:i,offer_id:u,memo:"Accept Offer"}}];$("transact",N)}async function me(r,o,i,u){let N=[{contract:"eosio.nft.ft",action:r=="UNIQ"?"rmnftofr.a":"rmfctofr.a",authorization:[{actor:v.state.accountName,permission:v.state.accountPerm?v.state.accountPerm:"active"}],data:{canceler:v.state.accountName,offer_id:u,memo:"Cancel Offer"}}];N[0].data[r=="UNIQ_FACTORY"?"factory_id":"nft_id"]=r=="UNIQ_FACTORY"?o:i,$("transact",N)}async function Q(){T(void 0,void 0),D()}async function P(){U(void 0),D()}return ke(()=>{he()}),(r,o)=>{var A,z,J,j,X,Y,H,G,W,Z,ee,te,ae,se,oe,ne;const i=w("Icon"),u=w("Button"),N=w("LoadingSpinner"),O=w("EasyDataTable"),E=w("Expand"),be=w("MediaArea"),ge=w("Code");return n(),l("div",qe,[Ce,De,h(p)?(n(),l("div",Pe,[Ee,e("div",Fe,[B(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>I.value=t),placeholder:"Factory Identifier",min:0,type:"number",onKeyup:M(P,["enter"]),class:"flex-grow rounded bg-neutral-950 text-neutral-200 pl-4 border border-neutral-700 focus:outline-none pr-4"},null,544),[[R,I.value]]),B(e("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>g.value=t),placeholder:"Serial Number",min:0,type:"number",onKeyup:M(P,["enter"]),class:"flex-grow rounded bg-neutral-950 text-neutral-200 pl-4 border border-neutral-700 focus:outline-none pr-4"},null,544),[[R,g.value]])]),f(u,{disabled:isNaN(Number(g.value))||_.value,onOnClick:P},{default:c(()=>[_.value?(n(),q(i,{key:1,icon:"fa-spinner",spin:""})):(n(),l("div",Be,"Search"))]),_:1},8,["disabled"]),f(u,{onOnClick:o[4]||(o[4]=t=>ie(p)?p.value=!h(p):p=!h(p))},{default:c(()=>[x(" Switch to Uniq ID Search ")]),_:1})])):(n(),l("div",Oe,[$e,e("div",Ue,[B(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>y.value=t),placeholder:"Uniq Identifier",min:0,type:"number",onKeyup:M(Q,["enter"]),class:"flex-grow rounded bg-neutral-950 text-neutral-200 pl-4 border border-neutral-700 focus:outline-none pr-4"},null,544),[[R,y.value]]),f(u,{disabled:isNaN(Number(y.value))||_.value,onOnClick:Q},{default:c(()=>[_.value?(n(),q(i,{key:1,icon:"fa-spinner",spin:""})):(n(),l("div",Te,"Search"))]),_:1},8,["disabled"])]),f(u,{onOnClick:o[1]||(o[1]=t=>ie(p)?p.value=!h(p):p=!h(p))},{default:c(()=>[x(" Switch to Factory Search")]),_:1})])),_.value?(n(),q(N,{key:2})):k("",!0),!_.value&&C.value==="failure"?(n(),l("div",Re,[Me,f(u,{onClick:pe},{default:c(()=>[x(" Clear Search ")]),_:1})])):k("",!0),!_.value&&a.value?(n(),l("div",Le,[Ve,e("div",Ke,[e("div",Qe,[Ae,e("div",ze,s(a.value.id),1)]),e("div",Je,[je,e("div",Xe,s(a.value.mintDate),1)]),e("div",Ye,[He,e("div",Ge,s(a.value.serialNumber),1)]),e("div",We,[Ze,e("div",et,[e("a",{class:"underline",target:"_blank",href:`/user?id=${a.value.owner}`},s(a.value.owner),9,tt)])]),e("div",at,[st,e("div",ot,[e("a",{class:"underline",target:"_blank",href:`${(z=(A=a.value.metadata)==null?void 0:A.cachedSource)==null?void 0:z.uri}`},s(h(S)((j=(J=a.value.metadata)==null?void 0:J.cachedSource)==null?void 0:j.uri)),9,nt)])]),e("div",it,[lt,e("div",rt,s(h(S)((H=(Y=(X=a.value.metadata)==null?void 0:X.cachedSource)==null?void 0:Y.integrity)==null?void 0:H.hash)),1)]),e("div",ct,[dt,e("div",ut,[e("a",{class:"underline",target:"_blank",href:`/uniqFactory?id=${a.value.factory.id}`},s(a.value.factory.id),9,vt)])]),e("div",_t,[pt,e("div",ht,[e("a",{class:"underline",target:"_blank",href:`${h(b).path}?id=${a.value.id}`},"Link",8,ft)])])]),mt,e("div",bt,[e("div",gt,[yt,e("div",xt,s(a.value.type),1)]),e("div",kt,[It,e("div",Nt,s(h(S)((W=(G=a.value.metadata)==null?void 0:G.content)==null?void 0:W.name)),1)]),e("div",wt,[St,e("div",qt,s(h(S)((ee=(Z=a.value.metadata)==null?void 0:Z.content)==null?void 0:ee.subName)),1)]),e("div",Ct,[Dt,e("div",Ot,s(h(S)((ae=(te=a.value.metadata)==null?void 0:te.content)==null?void 0:ae.description)),1)]),e("div",$t,[Ut,e("div",Tt,s((se=a.value.metadata.content)!=null&&se.attributes?`${a.value.metadata.content.attributes.length} attributes`:"No attributes found"),1)]),(oe=a.value.metadata.content)!=null&&oe.attributes?(n(),l("div",Pt,[(n(!0),l(L,null,le((ne=a.value.metadata.content)==null?void 0:ne.attributes,t=>(n(),l("div",Et,[e("div",Ft,s(t.key),1),e("div",Bt,[x(" Type: "+s(t.value.type)+" ",1),Rt,x(" Description: "+s(h(S)(t.value.description)),1)])]))),256))])):k("",!0)]),a.value.resale?(n(),l(L,{key:0},[Mt,e("div",Lt,[Vt,e("div",Kt,[Qt,e("div",At,s(a.value.resale.onSaleDate),1)]),e("div",zt,[Jt,e("div",jt,s(a.value.resale.price.amount)+" "+s(a.value.resale.price.currency.code),1)]),a.value.resale.promoterBasisPoints?(n(),l("div",Xt,[Yt,e("div",Ht,s(a.value.resale.promoterBasisPoints/100)+"% ("+s(a.value.resale.promoterBasisPoints)+") ",1)])):k("",!0),a.value.resale.shares?(n(),l("div",Gt,Zt)):k("",!0),a.value.resale.shares?(n(!0),l(L,{key:2},le(a.value.resale.shares,t=>(n(),l("div",ea,[e("div",ta,[e("a",{class:"underline",target:"_blank",href:`/user?id=${t.receiver}`},s(t.receiver),9,aa)]),e("div",sa,s(t.basisPoints/100)+"% ("+s(t.basisPoints)+")",1)]))),256)):k("",!0)])],64)):k("",!0),oa,e("div",na,[ia,f(E,{expanded:!0},{default:c(()=>[e("div",la,[f(O,{"table-class-name":"datatable-table",headers:d.value.dataTable.headers,items:d.value.dataTable.rows,"multi-sort":"","rows-items":["25","50","100"],"rows-per-page":100,"buttons-pagination":"","theme-color":"rgb(169 132 232 / var(--tw-text-opacity))"},{"item-uniqFactoryId":c(({uniqFactoryId:t})=>[t!="-"?(n(),l("a",{key:0,class:"underline",href:`/uniqFactory?id=${t}`,target:"_blank"},s(t),9,ra)):(n(),l("span",ca,s(t),1))]),"item-uniqId":c(({uniqId:t})=>[t!="-"?(n(),l("a",{key:0,class:"underline",href:`/uniq?id=${t}`,target:"_blank"},s(t),9,da)):(n(),l("span",ua,s(t),1))]),"item-buyer":c(({buyer:t})=>[e("a",{class:"underline",href:`/user?id=${t}`,target:"_blank"},s(t),9,va)]),"item-price":c(({price:t,priceUnit:F})=>[x(s(t)+" "+s(F),1)]),"item-cancelAction":c(({cancelAction:t})=>[t.status==="ACTIVE"&&t.buyer!=v.state.accountName?(n(),q(u,{key:0,size:"sm",disabled:!(t.owner==v.state.accountName&&v.state.accountName),onOnClick:F=>fe(t.type,t.owner,t.uniqId,t.offerId)},{default:c(()=>[x(" Accept ")]),_:2},1032,["disabled","onOnClick"])):(t.status=="EXPIRED"||t.buyer==v.state.accountName)&&v.state.accountName?(n(),q(u,{key:1,size:"sm",disabled:!v.state.accountName,onOnClick:F=>me(t.type,t.uniqFactoryId,t.uniqId,t.offerId)},{default:c(()=>[x(" Cancel ")]),_:2},1032,["disabled","onOnClick"])):k("",!0)]),"empty-message":c(()=>[_a]),_:1},8,["headers","items","theme-color"]),f(u,{disabled:d.value.totalCount==d.value.data.length||_.value,onOnClick:K,class:"w-full mt-6"},{default:c(()=>[x(s(_.value?"Loading...":`Load More (${d.value.totalCount-d.value.data.length})`),1)]),_:1},8,["disabled"])])]),_:1})]),e("div",pa,[ha,f(E,{expanded:!0},{default:c(()=>[e("div",fa,[f(be,{media:a.value.metadata},null,8,["media"])])]),_:1})]),e("div",null,[ma,f(E,null,{default:c(()=>[f(ge,{code:JSON.stringify(a.value)},null,8,["code"])]),_:1})])])):k("",!0)])}}});export{ya as default};
